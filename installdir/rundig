#!/bin/sh

#
# rundig
#
# $Id: rundig,v 1.4 1998/11/22 19:12:55 ghutchis Exp $
#
# This is a sample script to create a search database for ht://Dig.
#
if [ "$1" = "-v" ]; then
    verbose=-v
fi

#
# Set the TMPDIR variable if you want htmerge to put files in a location
# other than the default.  This is important if you do not have enough
# disk space for the big sort that htmerge runs.  Also, be aware that
# on some systems, /tmp is a memory mapped filesystem that takes away
# from virtual memory.
#
TMPDIR=@DATABASE_DIR@
export TMPDIR

@BIN_DIR@/htdig -i $verbose -s
@BIN_DIR@/htmerge $verbose -s
@BIN_DIR@/htnotify $verbose

#
# Create the endings and synonym databases if they don't exist
# or if they're older than the files they're generated from!
#

# Do they exist?
if [ ! -f @COMMON_DIR@/word2root.db ]
then
    @BIN_DIR@/htfuzzy $verbose endings
fi

if [ ! -f @COMMON_DIR@/synonyms.db ]
then
    @BIN_DIR@/htfuzzy $verbose synonyms
fi

# Are they too old?
if [ @COMMON_DIR/english.0 -nt @COMMON_DIR/word2root.db ] # not too likely
then
    @BIN_DIR@/htfuzzy $verbose endings
fi

if [ @COMMON_DIR/synonyms -nt @COMMON_DIR/synonyms.db ] # if you edit synonyms
then
    @BIN_DIR@/htfuzzy $verbose synonyms
fi